{% extends 'base.html' %}

{% load filtros %}
{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <div class="card" style="margin: 5px;">
                    <div class="card-body">
                        <h5 class="card-title text-center">Gráfico 01</h5>
                        <canvas id="card-01" style="display: block; width: 100px; height: 50px;"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card" style="margin: 5px;">
                    <div class="card-body">
                        <h5 class="card-title text-center">Gráfico 02</h5>
                        <canvas id="card-02" style="display: block; width: 100px; height: 50px;"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="card" style="margin: 5px;">
                    <div class="card-body">
                        <h5 class="card-title text-center">Gráfico 03</h5>
                        <canvas id="card-03" style="display: block; width: 100px; height: 50px;"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card" style="margin: 5px;">
                    <div class="card-body">
                        <h5 class="card-title text-center">Gráfico 04</h5>
                        <canvas id="card-04" style="display: block; width: 100px; height: 50px;"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Mapa exemplo</h5>
                        <div id="map" style="height: 520px; width: 800px; margin: 0 auto; text-align:center; line-height: 520px">
                            Downloading map...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}

{% block grafico %}
<script>
    $(document).ready(function(){
        var ctx1 = document.getElementById('card-01').getContext('2d');
        var myChart1 = new Chart(ctx1, {
            type: 'bar',
            data: {
                labels: [{% for prod in produtos %} '{{prod.nome}}', {%endfor%}],
                datasets: [{
                    label: 'Preço dos produtos',
                    data: [{% for prod in produtos %} {{prod.preco|dot}}, {%endfor%}],
                    backgroundColor: [
                        {% for prod in produtos %} 'rgba(255, 99, 132, 0.2)', {%endfor%}
                    ],
                    borderColor: [
                        {% for prod in produtos %} 'rgba(255, 99, 132, 1)', {%endfor%}
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });

        var ctx2 = document.getElementById('card-02').getContext('2d');
        var myChart2 = new Chart(ctx2, {
            type: 'doughnut',
            data: {
				datasets: [{
					data: [
                        {% for p in pizza %} {{p}}, {%endfor%}
                    ],
					backgroundColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(60, 123, 135, 1)',
					],
					label: 'Gráfico 02'
				}],
				labels: [{% for prod in produtos %} '{{prod.nome}}', {%endfor%}]
			},
			options: {
				responsive: true
			}
        });

        var ctx3 = document.getElementById('card-03').getContext('2d');
        var myChart3 = new Chart(ctx3, {
            type: 'line',
            data: {
				datasets: [
                {
					data: [
                        1, 5, 8, 12 
                    ],
					backgroundColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)'
                    ],
                    borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)'
                    ],
                    label: '2',
                    fill: false
                },
                {
					data: [
                        5, 9, 16, 30
                    ],
					backgroundColor: [
                    'rgba(54, 162, 235, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(54, 162, 235, 1)',
                    ],
                    borderColor: [
                    'rgba(54, 162, 235, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(54, 162, 235, 1)',
					],
                    label: '4',
                    fill: false
                },
                {
					data: [
                        {% for p in pizza %} {{p}}, {%endfor%}
                    ],
					backgroundColor: [
                    'rgba(255, 206, 86, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(255, 206, 86, 1)',
                    ],
                    borderColor: [
                    'rgba(255, 206, 86, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(255, 206, 86, 1)',
                    ],
                    label: '1', 
                    fill: false
                }
                ],
				labels: [{% for prod in produtos %} '{{prod.nome}}', {%endfor%}]
			},
			options: {
                responsive: true,
                scales: {
                    xAxes: [{
                        display: true,
                    }],
                    yAxes: [{
                        display: true,
				}]
			}
			}
        });

        var ctx4 = document.getElementById('card-04').getContext('2d');
        var myChart4 = new Chart(ctx4, {
            type: 'polarArea',
            data: {
				datasets: [{
					data: [
                        {% for p in pizza %} {{p}}, {%endfor%}
                    ],
					backgroundColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(60, 123, 135, 1)',
					],
					label: 'Gráfico 04'
				}],
				labels: [{% for prod in produtos %} '{{prod.nome}}', {%endfor%}]
			},
			options: {
				responsive: true
			}
        });
    });
</script>
{% endblock grafico %}

{% block map %}
<script>
Highcharts.getJSON('https://cdn.jsdelivr.net/gh/highcharts/highcharts@c116b6fa6948448/samples/data/us-counties-unemployment.json',
    function (data) {

        var countiesMap = Highcharts.geojson(
            Highcharts.maps['countries/us/us-all-all']
        ),
        // Extract the line paths from the GeoJSON
        lines = Highcharts.geojson(
            Highcharts.maps['countries/us/us-all-all'], 'mapline'
        ),
        // Filter out the state borders and separator lines, we want these
        // in separate series
        borderLines = Highcharts.grep(lines, function (l) {
            return l.properties['hc-group'] === '__border_lines__';
        }),
        separatorLines = Highcharts.grep(lines, function (l) {
            return l.properties['hc-group'] === '__separator_lines__';
        });

        // Add state acronym for tooltip
        Highcharts.each(countiesMap, function (mapPoint) {
        mapPoint.name = mapPoint.name + ', ' +
            mapPoint.properties['hc-key'].substr(3, 2);
        });

        document.getElementById('map').innerHTML = 'Rendering map...';

        // Create the map
        setTimeout(function () { // Otherwise innerHTML doesn't update
        Highcharts.mapChart('map', {
            chart: {
            borderWidth: 1,
            marginRight: 20 // for the legend
            },

            title: {
            text: 'Testando o mapa'
            },

            legend: {
            layout: 'vertical',
            align: 'right',
            floating: true,
            backgroundColor: ( // theme
                Highcharts.defaultOptions &&
                Highcharts.defaultOptions.legend &&
                Highcharts.defaultOptions.legend.backgroundColor
            ) || 'rgba(255, 255, 255, 0.85)'
            },

            mapNavigation: {
            enabled: true
            },

            colorAxis: {
            min: 0,
            max: 25,
            tickInterval: 5,
            stops: [[0, '#F1EEF6'], [0.65, '#900037'], [1, '#500007']],
            labels: {
                format: '{value}%'
            }
            },

            plotOptions: {
            mapline: {
                showInLegend: false,
                enableMouseTracking: false
            }
            },

            series: [{
            mapData: countiesMap,
            data: data,
            joinBy: ['hc-key', 'code'],
            name: 'Unemployment rate',
            tooltip: {
                valueSuffix: '%'
            },
            borderWidth: 0.5,
            states: {
                hover: {
                color: '#a4edba'
                }
            },
            shadow: false
            }, {
            type: 'mapline',
            name: 'State borders',
            data: borderLines,
            color: 'white',
            shadow: false
            }, {
            type: 'mapline',
            name: 'Separator',
            data: separatorLines,
            color: 'gray',
            shadow: false
            }]
        });
        }, 0);
    }
);
</script>    
{% endblock map %}
